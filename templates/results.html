{% extends "base.html" %}

{% block title %}GPT Pull-down{% endblock %}

{% block content %}
    <h1>GPT Pull-down</h1>
    <h5>> Brainstorm potential binding partners for your protein </h5>
    <hr style="border-top: 1px solid #ccc;">

    <p>Target Protein: {{ query }}</p>
    <table class="table">
    <thead>
      <tr>
        <th scope="col">Protein Name</th>
        <th scope="col">Confidence score (0-100)</th>
        <th scope="col">Function of the protein</th>
        <th scope="col">Function of the interaction</th>
        <th scope="col">Reasoning by GPT</th>
      </tr>
    </thead>
    <tbody>
      {% for protein in choices %}
        {% set protein_parts = protein.split(';') %}
        <tr>
          <td>{{ protein_parts[0].strip() if protein_parts|length > 0 else '' }}</td>
          <td>{{ protein_parts[1].strip() if protein_parts|length > 1 else '' }}</td>
          <td>{{ protein_parts[2].strip() if protein_parts|length > 2 else '' }}</td>
          <td>{{ protein_parts[3].strip() if protein_parts|length > 3 else '' }}</td>
          <td>{{ protein_parts[4].strip() if protein_parts|length > 4 else '' }}</td>
        </tr>
      {% endfor %}
    </tbody>
    </table>
    <a href="/" class="btn btn-primary">New Search</a>

    <!-- Replace the existing button with the following one -->
    <!-- <button class="btn btn-secondary" id="getPurificationProtocolBtn">Get purification protocol</button> -->

    <hr style="border-top: 1px solid #ccc;">
    <p style="color: grey;">Powered by GPT-3.5-turbo. Results may vary each time. </p>
    <p style="color: grey;">Created by Xiaozhe Ding with help from with GPT-4. About me: Protein engineer in <a href="https://glab.caltech.edu/" target="_blank">GradinaruLab@Caltech</a> (Twitter <a href="https://twitter.com/DingXiaozhe" target="_blank">@DingXiaozhe</a>, Personal page <a href="https://www.dingxiaozhe.com" target="_blank">dingxiaozhe.com</a>).</p>
    <p style="font-size: 0.8rem; color: grey;">Disclaimer: This website is for educational and entertainment purposes only and should not be used for medical applications. The owner disclaims any liability for actions taken based on the website's content or results. Always consult a healthcare professional for medical concerns. Use of this website indicates acceptance of these terms.</p>

<!-- Add the rest of the content -->
{% endblock %}

{% block scripts %}
    <script>
      $("#getPurificationProtocolBtn").on("click", function() {
        const query = encodeURIComponent("{{ query }}");
        const temperature = {{ "{:.1f}".format(temperature) }};
        const url = `/purification_protocol?query=${query}&temperature=${temperature}`;
        window.open(url, "_blank");
      });
    </script>
{% endblock %}
